import { objectMap } from "../tools/object-map.js";
import { isObject } from "../identities/is-object.js";
import { isFunction } from "../identities/is-function.js";
import { _context } from "../types/symbols/context-symbol.js";
import { _descriptor } from "../types/symbols/descriptor-symbol.js";
export function apiContext() {
    return function recurse({ expose, policy }) {
        return objectMap(expose, (value, key) => {
            if (isFunction(value))
                return {
                    [_descriptor]: true,
                    policy,
                    func: value,
                };
            else if (isObject(value))
                return {
                    [_context]: true,
                    ...recurse({ policy, expose: value })
                };
            else
                throw new Error(`unknown api context subtype for "${key}"`);
        });
    };
}
//# sourceMappingURL=api-context.js.map