import { readStream } from "./node/read-stream.js";
import { readRawHeaders } from "./node/read-raw-headers.js";
import { lowercasedHeaders } from "../tools/lowercased-headers.js";
export function makeRequestListener(servelet) {
    return async (request, response) => {
        const renrakuResponse = await servelet({
            path: request.url,
            body: await readStream(request),
            method: request.method.toLowerCase(),
            headers: lowercasedHeaders(readRawHeaders(request.rawHeaders)),
        });
        for (const [headerKey, headerValue] of Object.entries(renrakuResponse.headers))
            response.setHeader(headerKey, headerValue);
        response.statusCode = renrakuResponse.status;
        response.end(renrakuResponse.body);
    };
}
//# sourceMappingURL=make-request-listener.js.map