import { concurrent } from "../../../../toolbox/concurrent.js";
import { fetchUser } from "./user/fetch-user.js";
export async function signAuthTokens({ scope, appId, userId, tables, origins, lifespans, permissionsEngine, signToken, generateNickname, }) {
    const { user, permit } = await concurrent({
        user: fetchUser({ userId, authTables: tables, permissionsEngine }),
        permit: (async () => ({
            privileges: await permissionsEngine.getUserPrivileges(userId),
        }))(),
    });
    return concurrent({
        accessToken: signToken({
            payload: { appId, origins, user, permit, scope },
            lifespan: lifespans.access,
        }),
        refreshToken: signToken({
            payload: { userId: user.userId },
            lifespan: lifespans.refresh,
        }),
    });
}
//# sourceMappingURL=sign-auth-tokens.js.map