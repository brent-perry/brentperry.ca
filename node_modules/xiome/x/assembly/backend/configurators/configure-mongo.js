import mongodb from "mongodb";
import { dbbyMongo } from "../../../toolbox/dbby/dbby-mongo.js";
import { processBlueprint } from "../tools/process-blueprint.js";
import { memoryFlexStorage } from "../../../toolbox/flex-storage/memory-flex-storage.js";
export async function configureMongo({ blueprint, config }) {
    const mongo = await new mongodb.MongoClient(config.database.mongo.link, {
        useNewUrlParser: true,
        useUnifiedTopology: true,
    }).connect();
    const db = mongo.db(config.database.mongo.db);
    return {
        mockStorage: memoryFlexStorage(),
        database: processBlueprint({
            blueprint,
            process: path => dbbyMongo({
                collection: db.collection(path.join("-")),
            }),
        }),
    };
}
//# sourceMappingURL=configure-mongo.js.map